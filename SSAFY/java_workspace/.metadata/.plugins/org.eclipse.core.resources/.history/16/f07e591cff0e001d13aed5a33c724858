package com.ssafy.ws.step3;

import java.util.Arrays;

public class BookManagerImpl implements BookManager {
	private static BookManager manager = new BookManagerImpl();

	static BookManager getManager() {
		return manager;
	}

	private static Book[] book = new Book[100];
	static int size = 0;
	
	
	public void add(Book book) {
		this.book[this.size++] = book;
	}
	
	public void remove(String isbn) {
		//isbn을 가지고 있는 객체가 무엇인지 모두 스캔해야 함
		for (int i = 0; i < size; i++) {
			if(book[i].getIsbn().contains(isbn)) {
				for(int j = 0; j < size - i; j++) {
					book[i] = book[i+1];
				}
			}
		}
		book[size-1]=null;
		size--;
	}
	public Book[] bookList() {
		Book[] booklist = new Book[size];
		for(int i = 0; i <size; i++) {
			booklist[i] = book[i];
		}
		return booklist;
	}
	public Book[] searchByIsbn(String isbn) {
		// 입력한 값을 포함하고 있는 것들이 몇개인지 볼꺼야
		int cnt = 0;
		for (int i = 0; i < size; i++) {
			if (book[i].getIsbn().contains(isbn)) {
				cnt++;
			}
		}
		// 일치하는 책들을 담을 배열 생성
		Book[] bookisbn = new Book[cnt];

		// 배열에 값을 넣기
		for (int i = 0; i < size; i++) {
			int idx = 0;
			if (book[i].getIsbn().contains(isbn)) {
				bookisbn[idx++] = book[i];
			}
		}
		return bookisbn;
	}

	public Book[] searchByTitle(String title) {
		// 입력한 값을 포함하고 있는 것들이 몇개인지 볼꺼야
		int cnt = 0;
		for (int i = 0; i < size; i++) {
			if (book[i].getTitle().contains(title)) {
				cnt++;
			}
		}
		// 일치하는 책들을 담을 배열 생성
		Book[] all = new Book[cnt];

		// 배열에 값을 넣기
		for (int i = 0; i < size; i++) {
			int idx = 0;
			if (book[i].getTitle().contains(title)) {
				all[idx++] = book[i];
			}
		}
		return all;
	}
	public Book[] getBooks() {
		int cnt = 0;
		for (int i = 0; i <size; i++) {
			if (!(book[i] instanceof Magazine)) {
				cnt++;
			}
		}
		Book[] books = new Book[cnt];
		
		for (int i = 0; i < size; i++) {
			int idx = 0;
			if (!(book[i] instanceof Magazine)) {
				books[idx++] = book[i];
			}
		} 
		return books;
	} 
	public Magazine[] getMagazine() {
		int cnt = 0;
		for (int i = 0; i <size; i++) {
			if (book[i] instanceof Magazine) {
				cnt++;
			}
		}
		Magazine[] magazine = new Magazine[cnt];
		
		for (int i = 0; i < size; i++) {
			int idx = 0;
			if (book[i] instanceof Magazine) {
				magazine[idx++] = (Magazine)book[i];
			}
		} 
		return magazine;
	} 
	public int getTotalPrice() {
		int sum = 0;
		for (int i = 0; i < size; i++) {
			sum += book[i].getPrice();
		}
		return sum;
	}
	public double getPriceAvg() {
		int sum = 0;
		for (int i = 0; i < size; i++) {
			sum += book[i].getPrice();
		}
		return (double)(sum/size);
	}
}